# Non-Local Means using High Level Synthesis

## 1. Overview
This project implements the **Non-Local Means (NLM)** image denoising algorithm on an FPGA using **Xilinx Vivado HLS**.  
The design leverages HLS optimization pragmas such as **`PIPELINE`**, **`UNROLL`**, and **`ARRAY_PARTITION`** to significantly improve performance compared to a CPU implementation.

**Key Result:** Achieved **10.05 ms** execution time on FPGA vs **154 ms** on CPU (~15.33x speedup).

---

## 2. Features
- **Input/Output from BRAM**: Reads an image from BRAM into a local buffer, processes it, and writes the denoised image back to BRAM.
- **Line Buffer Optimization**: Uses an HLS-optimized line buffer for efficient window extraction.
- **Patch-Based Processing**: Complete **array partitioning** of candidate/reference patches and the local buffer for parallel access.
- **Loop Pipelining**: Pipelined buffer initialization, NLM computation, and row sliding to maximize throughput.
- **Gaussian-Weighted Distance**: L2 patch distance computation with a pre-defined Gaussian kernel.

---

## 3. Performance
| Platform | Execution Time | Speedup |
|----------|----------------|---------|
| CPU (C++ Reference) | 154 ms | 1× |
| FPGA (Vivado HLS) | **10.05 ms** | **~15×** |

---

## 4. Project Structure
- cpp/ # HLS source files
- syn/          # verilog files generated by HLS
- input+output  # input and output image
- reports/      # Vivado HLS synthesis reports
- README.md
